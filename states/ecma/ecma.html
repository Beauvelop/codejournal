<div class="ecma-container">
  <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?skin=desert"></script>

  <aside><span class="rot90">{{state}}</span></aside>
  <div class="ecma-entry entry">
    <pre>
      <!--entire page pre-->
      <h4 class="w20 ctr">events (Lynda)</h4>
      <h5>Adding event listeners</h5>
      <h6>Bascially they are no different in appearance from jQuery's events ('...on.('click', function(){}'...etc)</h6>
      <pre class="prettyprint">document.getElementById('thing').addEventListener('click', function() {
    alert("clicked the thing!")
},<span class="y underline">false</span>)</pre>
<h6>for some tags we can use preventDefault()  * see below *</h6>
<pre class="prettyprint">document.getElementById('container').addEventListener('click', function(e) {
      console.log("clicked the container!")
  },false)
document.getElementById('link').addEventListener('click', function(e) {
    e.preventDefault()
    console.log("clicked the link!")
    <span class="underline y">e.stopPropagation();</span> // only 'clicked the link!' fires.
},false)</pre>
<h5 class="dkred w40 ctrtxt">Capturing vs Bubbling</h5>
<p>Propagation is about how events are registered and 'caught' vis-a-vis other elements. Here, <span class="dkorange">e.stopPropagation()</span>
is called to prevent any events on parent elements. Therefore, we don't log to console</p>

<h5>2 ways to register an event.<br>You can 'catch' the event in the <em class="dkorange underline">Capturing Phase</em> so that a 'higher' DOM element listens down to its children for an event. div->ul->li->a <br><br>
Otherwise, an evt can be registered on the lowest element until it <em>bubbles</em> up to the div <br>
This is called capturing the event in <em class="dkorange underline">the Bubbling Phase</em></h5>
<pre class="prettyprint">
  document.getElementById('container').addEventListener('click', function(e) {
        console.log("clicked the container!")
  },<span class="underline">false</span>)
  document.getElementById('journalLink').addEventListener('click', function(e) {
    e.preventDefault()
    document.querySelector('#journalLink').style.color ='white';
      console.log(e.toElement.id);<sup class="ltred">*</sup>
  },<span class="underline">false</span>)
//having set both to false, the event will bubble up and return "journal" FIRST! and then "clicked container!"</pre>
<p><sup class="wh">*</sup>this is part of the 'e' object which gives the id value</p>

<div class="framed1"><pre>
  When you add an event handler to the event target itself, bubble vs capture is not applicable. At that level, you're not capturing or bubbling--you're on the target itself. The event handlers fire in the order in which they were registered.
</pre></div>
<h4 class="w60 dkblue">One more example:</h4>
<div class="caption-box">
  <img class="fRight w10" src="./img/link1.png" alt="link1">
  <br>
< div <span class="dkorange">id="myDiv"></span>
  < div>< a <span class="dkorange">id="coralLink"</span> href="https://www.google.com">LINK< /a>< /div>
< /div>
  </div><br><pre class="prettyprint">
    var myDiv = document.getElementById('myDiv');
      var coralLink = document.getElementById('coralLink');
      coralLink.addEventListener('click', function(e) {
        e.preventDefault();
        console.log('clicked CoralLink');
      }, true)

      myDiv.addEventListener('click', function() {
        console.log("clicked container");
      }, true)
  </pre>
  <div class="framed2 w40">
    <h5 class="fLeft">What will log first if I click on link?</h5>
    <img class="ans w20" src="./img/log1.png" alt="">
  </div>
<h4 class="w60 ctrtxt"><span class="dkred">REMEMBER: </span>'true' = capture phase.   'false' = Bubble Phase</h4>


<h5 class="ctrtxt w80">Event Issues (lynda Vid 5)</h5>
<div class="framed2">
<img class="w40" src="img/event2.png" alt="">
<img class="w40" src="img/event1.png" alt="">
<pre class="prettyprint">document.querySelector('#imgDiv').addEventListener('click', function(e) {
  var tgt = e.target;
  var tgtDad = e.target.parentNode; //parent of target
  var elemAmt = this.parentNode.querySelectorAll('div.subdiv').length; //counter

  if ((e.target.id !== 'imgDiv') && (elemAmt > 1)) { //until 1 remains and is not the containing div
    e.toElement.parentNode.removeChild(e.toElement);
  } else { // when only 1 remains...
    var photoTitle = e.target.title; //get title attr value
    document.getElementById('content').innerText = photoTitle //replace existing text
  }
}, false); //regist evt on image first! Bubble Phase
</pre>
</div>

<div class="framed1">
<h4 class="ctrtxt w80 underline">Creating elements with events</h4>
<h5 class="dkblue">This is always a 3 step process</h5>
<pre>
<p>1. Create element in memory (on a var)
2. Modify/define attrs, etc.
3. Attach it to the DOM</p>
</pre>
</div>

<div class="framed3 ltbg">Here's a clever way to put targets on a nodeList
<pre class="prettyprint">
// this turns a nodelist into an array-like object [they have length and indices]
// which can be queried.

var myTgts = document.getElementsByClassName('subdiv');
  for (var i = 0; i < myTgts.length; i++) {
    myTgts[i].addEventListener('click', function myFunction(e){
      alert("yes");
      console.log("tgt", e.target);
  }, false);
}</pre></div>
<hr>
      <h2 class="ltblue">setTimeout & setInterval : using Kirupa & Dan Wellman's tutes</h2>

  <pre class="prettyprint w80">
        setTimeout('console.log("bad!")', 4000); // 'bad' (after 4 secs)</pre>
    <p class="dkred"><sup class="ltred">*</sup>setTimeout is one of many methods that take a string and evaluate it as if it were code. But this is dangerous and insecure.
    <span class="ltred">NEVER pass a str as a first argument.</span></p>
    <pre class="prettyprint w40">
function log() {
  console.log("Hi there!");
}
setTimeout(log, 4000);
//(after 4sec) Hi there!
</pre>
    <h5><sup class="dkred">Here we call the named Fn instead of an interpolated string.</h5>

    <pre class="prettyprint w60">
  setTimeout(function log(msg) {
      console.log('Hi (using entire Fn as an arg)');
  }, 4000);

  <div class="dkbg">var logger = function log(msg) {
      console.log('Hi (using variable)');
  }
  setTimeout(logger, 4000);</div></pre>
  <h5 class="dkbg wh w60">2nd example uses setTimeout calling a Fn expression</h5>
  <h5 class="ctrtxt"><span class="underline navy">SetInterval</span> is a setTimeout that simply repeats itself.</h5>
  <pre class="prettyprint w60">
  function bounce(msg) {
    console.log("boing, boing");
  }
  setInterval(bounce, 3000);
  // boing, boing (every 3secs ad infinitum)
</pre>
  <h5>Now, we must define the interval in order to end it.
  We use <span class="dkorange">clearTimeout()</span> & <span class="dkorange">clearInterval()</span> methods.</h5>
  <pre class="prettyprint w60">
  let counter = 0;
  function bounce() {
    console.log("boing");
    counter += 1;

    if (counter === 5) {
      clearInterval(interval);
    }
  }
  var interval = setInterval(bounce, 3000);</pre>
  <h4><a target="_blank" href="https://youtu.be/zucCjXApXOU">Kirupa Tutorial</a></h4>
    <h4 class="ltbg w60">setTimeout(<span class="dkorange">anyFunction</span>, <em>timedelay</em>)</h4>
    <h4 class="ltbg w60">clearTimeout(<span class="dkorange">timeID</span>)</h4>
    <h6 class="">start it and cancel it.</h6>
  requestAnimationFrame() --requests a repaint and runs code as part of that repaint.
<pre class="prettyprint w40">
let timeID = setTimeout(runCode, 4000);
clearTimeout(timeID);</pre>
Here's an example;
<pre class="prettyprint w60">
var btn = $('button');

function drawText() {
  btn.after('< h1>Boom!< /h1>')
}

var timeID = setTimeout(drawText, 14000);
btn.on('click', function() {
btn.after('< h4>You cancelled it.< /h4>')
  clearTimeout(timeID);
})</pre>
<div class="ltbg w60"><h4 class="ctrtxt">var timeID =requestAnimationFrame(<em class="navy">anyFunction</em>)</h4>
  <h4 class="ctrtxt">requestAnimationFrame(<em class="navy">timeID</em>)</h4></div>
<h6>This is not part of some javascript browser's timer, but part of the browser's paint pipeline. It is more efficient and performant.</h6>
<pre class="prettyprint w40">
function drawText() {
  btn.after('< hr /> < h1>Boom!< /h1>')
}

function animationLoop() {
  drawText();
}
btn.on('click', function() {
  animationLoop();
})
</pre>
<h5>This uses gpu & cpu information to optimize performance.</h5>
<pre class="prettyprint">
  var currentPos = 0;
  var thing = document.querySelector("#thing")
  var requestAnimationFrame = window.requestAnimationFrame;

  function moveThing () {
    currentPos+= 5;
    thing.style.transform = "translate3d(" + currentPos + "px, 30px, 0px)";
    if (Math.abs(currentPos) >= 900) {
      currentPos = - 500;
    }
    requestAnimationFrame(moveThing);
  }

  moveThing();
</pre>
<em>cf.</em> <a href="https://youtu.be/rNsC1VI9388">Kirupa: requestAnimationFrame() for animation video</a>
  <hr>
  <h2 class="ltblue">Nice version of isPalindrome() using regex</h2>
  <h4><a target="_blank" href="https://medium.freecodecamp.com/two-ways-to-check-for-palindromes-in-javascript-64fea8191fd7">FCC Link</a></h4>
  <pre class="prettyprint w80">

  function isPalindrome(str) {
    var re = /[\W_]/g;
    var lowRegStr = str.toLowerCase().replace(re, ''); //replaces all non chars with nothing.
    var revStr = lowRegStr.split('').reverse().join(''); //makes Arr, revs, joins.
    var bool = lowRegStr === revStr; //two Strings compared
    return bool; //truthy return
  }
  isPalindrome("naan")
  isPalindrome("Beau")

</pre>
    <h2 class="ltblue">Nice example of <span class="dkred">.replace()</span> String method</h2>
    <h4><a target="_blank" href="https://www.tutorialspoint.com/java/java_string_replace.htm">link</a></h4>

    <pre class="prettyprint w80">

  var happyThought = "This is really great!";
  var sadThought = "tragic!";

  var newThought = happyThought.replace('great!', sadThought);
  // Simple String Method: first arg is old substr, 2nd arg is nuSubstr.

  console.log(newThought);

</pre>
    <hr>
    <h2 class="ltblue">Nice example of <span class="dkred">recursion</span> with factorials</h2>
    <h4><a target="_blank" href="https://frontendmasters.com/courses/computer-science/exercise-1-solution">solution explained here</a></h4>

    <pre class="prettyprint w80">

  function factorialize(num) {
      if (num < 2) {
        return 1;
      }
      return num * factorialize(num - 1);
    }

    factorialize(17);
    factorialize(3);
    factorialize(20);
  </pre>
    <span class="ltred bg">Open another browser to run it to avoid mishaps with infinite loops</span>



    <hr>

    <h2 class="ltblue">Nice example of String Method: <span class="dkred">.replace();</span></h2>
    <h4><a target="_blank" href="https://www.freecodecamp.com/challenges/search-and-replace">search-and-replace</a></h4>

    <pre class="prettyprint w80">

  function myReplace(str, before, after) {

        if (before === before.toLowerCase()) {
          str.replace(before, after);
          return str.replace(before, after);
        } else {

          var newafter = after.replace(after[0], after[0].toUpperCase())
          return str.replace(before, newafter);
        }

      }
  //myReplace('A quick brown fox jumped over the lazy dog', 'jumped', 'leaped')
  myReplace('He is Sleeping on the couch', 'Sleeping', 'sitting')

</pre>

    </pre>
  </div>
  <!--entry end-->


</div>

<!-- <h2 class="ltblue">TITLEHERE</h2>
<h4><a target="_blank" href="LINKADDY">LINKTITLE</a></h4>
<pre class="prettyprint w80">
  CODEPLACEHOLDER
</pre>
<p>CAPTION PLACEHOLDER</p>
-->
